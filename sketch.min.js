let player,pipe,score;const gravity=.15,jumpHeight=3.5;let playing,canScore,points=[];function setup(){createCanvas(200,400),player={x:width/6,y:height/2,w:25,vel:0},pipe={x:width,y:random(-height/2,0),w:40,h:height/2,gapH:height/4,vel:-1.5},score=0,playing=!0,canScore=!0,textAlign(CENTER);for(let p=0;p<50;p++)points.push([random(0,2*width),random(0,height)])}function draw(){drawBackground(),updatePlayer(),updatePipe(),drawPlayer(),drawPipe(),fill(255),playing?(textSize(24),text(score,10,20)):text("You scored "+score.toString()+"\nPress Space\n to play again",width/2,height/2)}function updatePlayer(){player.vel+=.15,player.y+=player.vel,(checkLoss()||player.y<0||player.y>height)&&(playing=!1),checkPoint()?canScore&&(score+=1,canScore=!1):canScore=!0}function drawPlayer(){fill(255,255,0),noStroke(),square(player.x,player.y,player.w)}function updatePipe(){playing&&(pipe.x+=pipe.vel),pipe.x<-pipe.w&&(pipe.x=width+30,pipe.y=random(-height/2,0),pipe.vel-=.05)}function drawPipe(){fill(0,255,0),noStroke(),rect(pipe.x,pipe.y,pipe.w,pipe.h),rect(pipe.x,pipe.y+pipe.h+pipe.gapH,pipe.w,height)}function checkLoss(){return!!(player.x+player.w>=pipe.x&&player.x<=pipe.x+pipe.w&&(player.y+player.w>=pipe.y&&player.y<=pipe.y+pipe.h||player.y+player.w>=pipe.y+pipe.h+pipe.gapH&&player.y<=pipe.y+pipe.h+height+pipe.gapH))}function checkPoint(){return!!(player.x+player.w>=pipe.x)&&!!(player.x<=pipe.x+pipe.w)&&!!(player.y+player.w>=pipe.y+pipe.h)&&!!(player.y<=pipe.y+pipe.h+pipe.gapH)}function drawBackground(){background(30,150);for(let p=0;p<50;p++)playing&&(points[p][0]-=.1),points[p][0]<0&&(points[p][0]=2*width),stroke(100),strokeWeight(5),point(points[p][0],points[p][1]),stroke(255),strokeWeight(2),point(points[p][0],points[p][1])}function keyPressed(){" "===key&&(playing?player.vel=-3.5:setup())}
